# 작업 지침
- 모든 설명, 커밋 메시지, PR 본문은 한국어로 작성합니다.
- 보드 시스템 클럭은 50MHz 입력(`clk_50mhz`)을 기준으로 하며, `clk_divider`의 `INPUT_FREQ` 기본값도 50MHz로 유지합니다.
- 리셋 신호는 active-high `rst` 비동기 방식으로 통일합니다.
- 코드 스타일은 Verilog-2001을 사용하고, 비트 폭을 명시합니다.
- 테스트 코드는 작성하지 마세요.
- 새 모듈은 파일 단위로 작성하며, 상위 모듈에서 하위 모듈 순으로 정렬합니다.
- DC 모터 제어는 사용하지 않으므로 `dc_pwm` 관련 포트를 추가하지 않습니다.
- `pinMap.txt` 파일을 참고하여 핀맵을 설정합니다.

## 추가 정리 (2024-락업)
- 버튼 입력은 보드 특성에 맞춰 active-low로 받고 `button_debouncer`에서 내부 active-high 신호로 변환합니다.
- 단일 7세그와 8배열 7세그 모두 active-low 공통애노드 기준이며, 세그먼트 비트 순서는 `[0]=A, [1]=B, [2]=C, [3]=D, [4]=E, [5]=F, [6]=G, [7]=DP` 입니다.
- 기어 스위치는 `DIP_SW1`~`DIP_SW6`(낮은 번호가 낮은 단수)로 읽고, 여러 개가 켜지면 가장 높은 단수를 선택합니다. `DIP_SW8`은 전체 시스템 리셋으로 사용합니다.
- `car_dashboard_top` 최상위 모듈 포트명과 `constraints.xdc` 매핑을 수정할 때는 `pinMap.txt`를 우선 확인하고 본 파일의 맵핑 규칙을 유지하세요.
- 속도/기어/RPM 연산은 `engine_model`의 계산식을 그대로 사용하여 가짜 수치를 만들지 말고, 기어비와 최종감속, 타이어 회전수 환산 계수를 변경할 때는 주석을 남겨 근거를 함께 기록합니다.
- 서보는 50Hz PWM(1.0~2.0ms)로 구동하며, 엔진 RPM은 0~8000rpm 범위에서 0~100%로 정규화해 `servo_pwm`에 전달합니다.
- 7세그 값이 없는 자리(nibble)는 `4'hF`로 채워 꺼진 상태를 표현합니다.

## 2024-12 수정 메모
- `servo_pwm`는 주기 시작점에서 하이를 유지하도록 `cnt < high_count` 비교로 구현해 주세요. 듀티 계산은 조합 논리로 두어 서보 펄스 폭이 즉시 반영되도록 유지합니다.
- 7세그먼트 포트 비트 순서는 `[0]=A ... [6]=G, [7]=DP` 기준으로 `constraints.xdc`를 배치했습니다. 핀 교차를 피하기 위해 추가 모듈을 만들지 말고 동일한 비트 순서를 유지하세요.
- 기어별 속도 상한은 1단 30km/h, 2단 70km/h, 3단 130km/h, 4단 200km/h, 5단 300km/h, 6단 400km/h로 고정하며, `engine_model`에서 단속별 상한을 초과하지 않도록 클램프합니다.

# 기능 정의
1. 해당 프로젝트는 FPGA 보드를 이용해 수동 변속 자동차의 기어 변속/rpm/속도를 가시화하는 프로젝트입니다.
- `LED`를 이용하여 rpm 과부화 정도를 표시합니다. rpm이 낮을 때 LED 1개를 점등하고 rpm이 과부화 되었을 때 8개를 모두 점등합니다.
- `Full Color LED`를 이용하여 rpm 과부화 정도를 RGB로 표현합니다. 정상 범주일 때 초로색, 주의단계일 때 노란색, 과부화되었을 때 빨간색으로 표시힙니다.
- `Servo Motor`를 이용하여 rpm 을 표시합니다. 자동차의 rpm 게이지와 동일하며 속도가 높아질 수록 시계방향으로 회전하다가 속도가 낮아지거나 단속이 높아져서 rpm이 낮아지면 다시 반시계 방향으로 회전합니다. 서보모터는 끊어지는 느낌이 나지않도록 연속적으로 회전합니다.
- `7-Segment`를 이용하여 단속을 표현합니다. N단은 0으로 표시하고 최대 7단까지 지원합니다.
- `8 Array 7-Segment`를 이용하여 현재 속도를 표시합니다. 0부터 최대 400키로미터까지 지원합니다.
- `KEY08`을 이용하여 가속, `KEY11`을 이용하여 감속합니다.
- `DIP_SW8`을 이용하여 모든 속도 및 상태를 리셋합니다.
- `DIP_SW1-6`을 이용하여 단속을 조절합니다. 6->1로 갈수록 높은 단속이며 여러개가 켜져있을 경우 제일 높은 단속을 선택합니다. 모두 꺼져있을 경우 N단으로 설정합니다.
- `PIEZO`를 이용하여 엔진소리를 표현합니다.
